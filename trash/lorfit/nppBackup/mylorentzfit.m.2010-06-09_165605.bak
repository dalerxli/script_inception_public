function [x0, y0, A, w] = mylorentzfit(x,yOrig, x0, y0, A, w)
% y=y0+(2*A/pi).*(w./(4*(x-x0).^2+w.^2));


figure;
plot(x,yOrig,'ob');
hold on;

%% define start point

% default arguments
if nargin<3, x0=7; end
if nargin<4, y0=2.5; end
if nargin<5, A=5; end
if nargin<6, w=4; end

vStart=[y0,A,w,x0];
fprintf('Start:  y0=%f  A=%f  w=%f  x0=%f\n',vStart(1),vStart(2),vStart(3),vStart(4)); 
yStart=fun(vStart,x);
plot(x,yStart,'-r');

%% using nlinfit
vEnd=nlinfit(x,yOrig,@fun,vStart);
yEnd=fun(vEnd,x);
fprintf('End:  y0=%f  A=%f  w=%f  x0=%f\n',vEnd(1),vEnd(2),vEnd(3),vEnd(4)); 
plot(x,yEnd,'-g');
legend('Orig','Start','End');
set(gca,'Color',[0.7,0.7,0.7]);
set(gcf,'Color',[1,1,1]);
